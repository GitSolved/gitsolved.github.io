---
title: "BYOVD Attack: Bring Your Own Vulnerable Driver Exploitation"
author: SecureYourGear Team
date: 2025-10-15 14:00:00 -0400
categories: [Red Team, Windows Security]
tags: [byovd, driver-exploitation, privilege-escalation, edr-bypass, kernel, windows, rootkit, malware-analysis]
---

## What is BYOVD?

BYOVD (Bring Your Own Vulnerable Driver) is an advanced attack technique where adversaries exploit legitimate but vulnerable signed kernel drivers to gain kernel-level code execution on Windows systems. This method bypasses traditional security controls by leveraging drivers that are already trusted by the operating system.

**Core Concept**: Instead of writing custom kernel exploits that trigger EDR/AV detection, attackers bring pre-existing vulnerable drivers (often legitimately signed by Microsoft or hardware vendors) and abuse their known vulnerabilities to escalate privileges or disable security products.

### Why BYOVD is Effective

- **Trusted Signatures**: Legitimate drivers are signed with valid certificates, bypassing Driver Signature Enforcement (DSE)
- **Kernel Access**: Once loaded, drivers operate at Ring 0 with full kernel privileges
- **EDR Blind Spot**: Security products often trust signed drivers, creating detection gaps
- **Living Off The Land**: Uses existing vendor-signed binaries rather than malicious code

## Real-World BYOVD Attacks

### Notable Incidents

**1. BlackByte Ransomware (2022)**
- Exploited vulnerable RTCore64.sys driver from MSI Afterburner
- Used driver to terminate EDR processes running in kernel mode
- Allowed ransomware to execute without detection

**2. Lazarus APR (North Korea, 2021-2023)**
- Deployed multiple vulnerable drivers including Dell DBUtil_2_3.sys
- Bypassed Windows security mechanisms
- Achieved persistent kernel-level access

**3. Scattered Spider / ALPHV (2023)**
- Used vulnerable Gigabyte driver (gdrv.sys)
- Disabled EDR agents at kernel level
- Conducted credential theft and lateral movement

## Attack Methodology

### Stage 1: Driver Selection

Attackers identify vulnerable signed drivers from public databases:

**Common Vulnerable Drivers:**
- `RTCore64.sys` (MSI Afterburner) - CVE-2019-16098
- `gdrv.sys` (Gigabyte) - Arbitrary read/write primitives
- `DBUtil_2_3.sys` (Dell BIOS Utility) - Memory manipulation
- `AsUpIO64.sys` (ASUS) - Physical memory access
- `HW.sys` (EVGA Precision X1) - Kernel arbitrary write

**Microsoft's Vulnerable Driver Blocklist**: Windows maintains a revocation list, but many vulnerable drivers remain unblocked due to compatibility concerns.

### Stage 2: Driver Deployment

**Technical Steps:**

1. **Gain Initial Access**: Attacker obtains admin-level access via phishing, exploit, or credentials
2. **Drop Driver**: Copy vulnerable driver to `C:\Windows\System32\drivers\`
3. **Create Service**: Register driver as a kernel service
   ```cmd
   sc create VulnDriver binPath= C:\Windows\System32\drivers\vuln.sys type= kernel
   sc start VulnDriver
   ```
4. **Verify Load**: Driver loads successfully due to valid signature

### Stage 3: Exploitation

Once loaded, the vulnerable driver provides primitives for malicious operations:

**Common Exploitation Techniques:**

**1. EDR/AV Process Termination**
- Locate EDR processes (e.g., MsMpEng.exe, CrowdStrike)
- Use driver's arbitrary write capability to corrupt process structures
- Terminate security agents running in protected mode

**2. Kernel Callback Removal**
- Identify kernel callbacks registered by security products
- Use driver to directly manipulate kernel memory
- Remove callbacks monitoring process creation, registry, file system

**3. Direct Kernel Object Manipulation (DKOM)**
- Hide processes by unlinking EPROCESS structures
- Elevate token privileges to SYSTEM
- Bypass access control checks

**Example Attack Flow (RTCore64.sys):**
```
1. Load RTCore64.sys (signed MSI driver)
2. Send IOCTL 0x80002040 to map physical memory
3. Locate target process in kernel memory
4. Modify process token privileges to SeDebugPrivilege
5. Inject payload into protected process
```

### Stage 4: Post-Exploitation

With kernel access established:
- Deploy ransomware/malware without AV detection
- Steal credentials from LSASS memory
- Install kernel-mode rootkit for persistence
- Disable Windows Event Logging (ETW)

## Detection Strategies

### For Blue Teamers

**1. Driver Load Monitoring**

Monitor Sysmon Event ID 6 (Driver Loaded):
```xml
<RuleGroup name="BYOVD Detection" groupRelation="or">
  <DriverLoad onmatch="include">
    <ImageLoaded condition="contains">RTCore64.sys</ImageLoaded>
    <ImageLoaded condition="contains">gdrv.sys</ImageLoaded>
    <ImageLoaded condition="contains">DBUtil_2_3.sys</ImageLoaded>
  </DriverLoad>
</RuleGroup>
```

**2. Service Creation Anomalies**

Alert on kernel service creation by non-standard installers:
- Service type = kernel (type 1)
- Created by processes other than installer.exe or setup.exe
- Service binary in unusual locations (not `%SystemRoot%\System32\drivers\`)

**3. Driver Hash Validation**

Maintain known-good driver hash database:
```powershell
Get-ChildItem C:\Windows\System32\drivers\*.sys | 
  Get-FileHash -Algorithm SHA256 | 
  Where-Object {$_.Hash -notin $KnownGoodHashes}
```

**4. Behavioral Analysis**

Watch for:
- Unsigned executables communicating with kernel drivers via IOCTL
- Rapid EDR process terminations following driver loads
- Memory scanning activity targeting kernel structures

### EDR/SIEM Detection Rules

**Sigma Rule Example:**
```yaml
title: Suspicious Kernel Driver Load
status: experimental
description: Detects loading of known vulnerable drivers used in BYOVD attacks
references:
    - https://www.loldrivers.io/
tags:
    - attack.privilege_escalation
    - attack.t1068
logsource:
    product: windows
    category: driver_load
detection:
    selection:
        ImageLoaded|endswith:
            - '\RTCore64.sys'
            - '\gdrv.sys'
            - '\DBUtil_2_3.sys'
    condition: selection
falsepositives:
    - Legitimate MSI Afterburner installations
level: high
```

## Mitigation Strategies

### Defensive Measures

**1. Enable Windows Vulnerable Driver Blocklist**

Windows 11 and Windows Server 2022+ include a built-in blocklist:
```powershell
# Enable via Group Policy or Registry
reg add "HKLM\SYSTEM\CurrentControlSet\Control\CI\Config" /v "VulnerableDriverBlocklistEnable" /t REG_DWORD /d 1 /f
```

**2. Application Control Policies**

Implement Windows Defender Application Control (WDAC):
- Block all drivers not in approved vendor list
- Enforce Microsoft-signed drivers only
- Create custom driver allowlists

**3. Kernel DMA Protection**

Enable VBS (Virtualization-Based Security) and HVCI:
```powershell
# Verify HVCI status
Get-ComputerInfo | Select-Object DeviceGuardSecurityServicesRunning
```

**4. Third-Party Solutions**

- **Microsoft Vulnerable Driver Blocklist**: https://aka.ms/VulnerableDriverBlocklist
- **LOLDrivers Project**: Community-maintained database of vulnerable drivers
- Regularly update driver blocklists in EDR platforms

**5. Least Privilege**

- Restrict admin rights to prevent driver installation
- Implement PAW (Privileged Access Workstations) for administrators
- Use JIT (Just-In-Time) admin access

### Incident Response

**If BYOVD Attack Detected:**

1. **Immediate Containment**
   - Isolate affected systems from network
   - Capture memory dump before shutdown
   
2. **Forensic Analysis**
   ```powershell
   # List all loaded drivers
   driverquery /v
   
   # Check service registry for kernel services
   Get-ItemProperty "HKLM:\SYSTEM\CurrentControlSet\Services\*" | 
     Where-Object {$_.Type -eq 1}
   
   # Identify suspicious driver loads
   Get-WinEvent -FilterHashtable @{LogName='Microsoft-Windows-Sysmon/Operational'; ID=6}
   ```

3. **Eradication**
   - Unload malicious driver: `sc stop VulnDriver`
   - Delete driver file and service entry
   - Update driver blocklist
   - Patch vulnerable legitimate drivers

4. **Recovery**
   - Rebuild compromised systems from known-good images
   - Reset credentials for accessed accounts
   - Review persistence mechanisms (scheduled tasks, registry autorun)

## Advanced BYOVD Techniques

### Driver Chaining

Sophisticated attackers chain multiple drivers:
1. Load signed vulnerable driver A (provides arbitrary read)
2. Use driver A to locate and modify driver signature verification
3. Load unsigned malicious driver B (full rootkit capabilities)

### Kernel Code Signing Bypass

Some drivers provide primitives to:
- Patch PatchGuard (Kernel Patch Protection) in memory
- Disable DSE (Driver Signature Enforcement) at runtime
- Modify kernel security descriptors

### Fileless BYOVD

Load drivers directly from memory without touching disk:
- Exploit driver with memory mapping capabilities
- Map unsigned driver from process memory into kernel space
- Evades file-based detection

## Key Takeaways

**For Red Teamers:**
- BYOVD remains effective against many enterprise EDR solutions
- Use drivers from LOLDrivers.io project for tested vulnerabilities
- Chain with other techniques (e.g., token manipulation, LSASS dumping)
- Understand detection methods to evade monitoring

**For Blue Teamers:**
- Enable Windows Vulnerable Driver Blocklist immediately
- Monitor driver load events (Sysmon Event ID 6) religiously
- Maintain updated IoC lists from threat intel feeds
- Test EDR capabilities against BYOVD techniques in purple team exercises

**The Bottom Line**: BYOVD attacks exploit the trust relationship between operating systems and signed drivers. Defense requires layered controls: blocklists, behavioral monitoring, application control, and rapid incident response. As Microsoft expands its blocklist, attackers will continue discovering new vulnerable drivers - this is an ongoing arms race.

---

## References

- [Microsoft Recommended Driver Block Rules](https://learn.microsoft.com/en-us/windows/security/application-security/application-control/windows-defender-application-control/design/microsoft-recommended-driver-block-rules)
- [LOLDrivers Project - Living Off The Land Drivers](https://www.loldrivers.io/)
- [MITRE ATT&CK T1068 - Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068/)
- [BlackByte Ransomware BYOVD Analysis - Sophos](https://news.sophos.com/en-us/2022/10/04/blackbyte-ransomware-returns/)

## Tools for Research

- **EDRSandblast**: Open-source tool demonstrating BYOVD techniques
- **KDU (Kernel Driver Utility)**: Driver exploitation framework
- **PPLKiller**: Uses BYOVD to terminate PPL-protected processes
- **Backstab**: Kills EDR/AV processes using vulnerable drivers

